# Codebase Structure

**Analysis Date:** 2026-01-13

## Directory Layout

```
zsm/
├── .cargo/                     # Cargo configuration
│   └── config.toml            # Default WASM target
├── .github/                    # GitHub configuration
│   └── workflows/             # CI/CD pipelines
│       ├── ci.yml             # Test, build, lint, format
│       └── release-please.yml # Automated releases
├── src/                        # Source code
│   ├── main.rs                # Plugin entry point
│   ├── state.rs               # Central state management
│   ├── config.rs              # Configuration parsing
│   ├── new_session_info.rs    # Session creation workflow
│   ├── session/               # Session management module
│   ├── ui/                    # UI rendering module
│   └── zoxide/                # Zoxide integration module
├── target/                     # Build artifacts (gitignored)
├── Cargo.toml                  # Project manifest
├── Cargo.lock                  # Dependency lock
├── CLAUDE.md                   # Developer instructions
├── README.md                   # User documentation
├── CHANGELOG.md                # Version history
├── LICENSE                     # MIT license
├── plugin.kdl                  # Example plugin config
└── zellij.kdl                  # Development layout
```

## Directory Purposes

**src/**
- Purpose: All Rust source code
- Contains: Plugin implementation, modules, types
- Key files: `main.rs` (entry), `state.rs` (orchestrator)
- Subdirectories: `session/`, `ui/`, `zoxide/`

**src/session/**
- Purpose: Session management and operations
- Contains: `SessionManager`, `SessionItem`, `SessionAction` types
- Key files: `manager.rs` (operations + tests), `types.rs` (enums)
- Subdirectories: None

**src/ui/**
- Purpose: Terminal UI rendering
- Contains: `PluginRenderer`, `Theme`, `Colors`, component helpers
- Key files: `renderer.rs` (main rendering), `theme.rs` (colors), `components.rs` (helpers)
- Subdirectories: None

**src/zoxide/**
- Purpose: Zoxide CLI integration and search
- Contains: `ZoxideDirectory`, `SearchEngine`
- Key files: `directory.rs` (struct), `search.rs` (fuzzy matching)
- Subdirectories: None

**.github/workflows/**
- Purpose: CI/CD automation
- Contains: GitHub Actions workflow files
- Key files: `ci.yml` (tests/linting), `release-please.yml` (releases)
- Subdirectories: None

## Key File Locations

**Entry Points:**
- `src/main.rs` - Plugin entry, `register_plugin!` macro, `ZellijPlugin` trait implementation

**Configuration:**
- `Cargo.toml` - Rust project manifest, dependencies
- `.cargo/config.toml` - Default build target (wasm32-wasip1)
- `src/config.rs` - Runtime configuration parsing from Zellij layout

**Core Logic:**
- `src/state.rs` - Central `PluginState` struct, key handling, item coordination (709 lines)
- `src/main.rs` - Event handling, zoxide execution, smart naming algorithm (503 lines)
- `src/session/manager.rs` - Session operations, stability tracking (337 lines)

**UI:**
- `src/ui/renderer.rs` - Main rendering logic, screen dispatch (431 lines)
- `src/ui/components.rs` - UI component rendering helpers
- `src/ui/theme.rs` - Color theming with indexed colors

**Testing:**
- `src/session/manager.rs` - Inline `#[cfg(test)]` module with 7 unit tests

**Documentation:**
- `README.md` - User-facing installation and usage guide
- `CLAUDE.md` - Developer instructions, architecture overview
- `CHANGELOG.md` - Version history

## Naming Conventions

**Files:**
- snake_case for all Rust files: `manager.rs`, `types.rs`, `renderer.rs`
- `mod.rs` for module public exports
- UPPERCASE.md for important docs: `README.md`, `CLAUDE.md`, `CHANGELOG.md`

**Directories:**
- snake_case: `session/`, `ui/`, `zoxide/`
- Plural for collections: `workflows/`

**Special Patterns:**
- `mod.rs` - Re-exports public API for each module
- Test modules inline with `#[cfg(test)]` attribute

## Where to Add New Code

**New Feature:**
- Primary code: Depends on feature domain (`src/session/`, `src/ui/`, `src/zoxide/`)
- State integration: `src/state.rs`
- Tests: Inline in source file with `#[cfg(test)]`
- Config if needed: `src/config.rs`

**New Session Operation:**
- Implementation: `src/session/manager.rs`
- Types: `src/session/types.rs`
- Tests: `src/session/manager.rs` (in `mod tests`)

**New UI Component:**
- Implementation: `src/ui/components.rs` or `src/ui/renderer.rs`
- Theming: `src/ui/theme.rs`

**New Zoxide Feature:**
- Directory handling: `src/zoxide/directory.rs`
- Search logic: `src/zoxide/search.rs`

**Utilities:**
- Consider adding to existing modules or `src/state.rs`
- No dedicated utils directory exists

## Special Directories

**target/**
- Purpose: Build output and artifacts
- Source: Generated by Cargo
- Committed: No (in .gitignore)
- Key output: `target/wasm32-wasip1/release/zsm.wasm`

**.planning/**
- Purpose: GSD planning documents (this codebase map)
- Source: Created by `/gsd:map-codebase`
- Committed: Depends on project preference

---

*Structure analysis: 2026-01-13*
*Update when directory structure changes*
