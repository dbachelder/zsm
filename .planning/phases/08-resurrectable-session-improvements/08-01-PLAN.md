---
phase: 08-resurrectable-session-improvements
plan: 01
type: execute
wave: 1
depends_on: []
files_modified: [src/state.rs, src/ui/renderer.rs, src/config.rs]
autonomous: true
---

<objective>
Add Alt+D toggle for resurrectable sessions with pink coloring for visual distinction.

Purpose: Replace config-based visibility with runtime toggle, making dead sessions easily accessible without config file changes while keeping the default view clean.
Output: Alt+D toggles resurrectable session visibility, dead sessions appear in pink (color index 3) between live sessions and directories.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/08-resurrectable-session-improvements/08-CONTEXT.md

@src/state.rs
@src/ui/renderer.rs
@src/config.rs
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add show_dead_sessions state and Alt+D toggle</name>
  <files>src/state.rs</files>
  <action>
1. Add `show_dead_sessions: bool` field to `PluginState` struct, default `false` in `new()`.

2. In `handle_main_screen_key()`, add match arm for `Alt+D`:
```rust
BareKey::Char('d') if key.has_modifiers(&[KeyModifier::Alt]) => {
    self.show_dead_sessions = !self.show_dead_sessions;
    true
}
```

3. In `combined_items()` around line 182, change the condition from `self.config.show_resurrectable_sessions` to `self.show_dead_sessions`:
```rust
// Add resurrectable sessions if toggled on
if self.show_dead_sessions {
```

This keeps the same logic but uses runtime state instead of config.
  </action>
  <verify>cargo build --target wasm32-wasip1 compiles without errors</verify>
  <done>Alt+D toggles show_dead_sessions field, which controls resurrectable session visibility</done>
</task>

<task type="auto">
  <name>Task 2: Update resurrectable session color to pink and add help text</name>
  <files>src/ui/renderer.rs</files>
  <action>
1. In `render_session_item()` around line 454, change the color index for resurrectable sessions from 1 (cyan) to 3 (pink):
```rust
// Before:
theme.content(&display_text).color_range(1, 2..name_end)
// After:
theme.content(&display_text).color_range(3, 2..name_end)
```
Do the same for the non-themed branch at line 456.

2. In `render_help_text()`, update row2 to include Alt+D toggle. Change from:
```rust
"Ctrl+Enter: Quick • Alt+r: Rename • Ctrl+r: Reload • Del: Kill"
```
To:
```rust
"Ctrl+Enter: Quick • Alt+r: Rename • Alt+d: Dead • Ctrl+r: Reload • Del: Kill"
```

Note: Use lowercase 'd' in help text to match convention, but the keybinding itself handles both cases since Zellij normalizes to lowercase.
  </action>
  <verify>cargo build --target wasm32-wasip1 compiles; cargo clippy --target wasm32-wasip1 -- -D warnings passes</verify>
  <done>Resurrectable sessions display in pink; help text shows Alt+d toggle</done>
</task>

<task type="auto">
  <name>Task 3: Remove show_resurrectable_sessions config option</name>
  <files>src/config.rs</files>
  <action>
1. Remove `show_resurrectable_sessions: bool` field from the `Config` struct (line 31).

2. Remove the default value from `Default::default()` (line 45).

3. Remove the parsing logic from `from_zellij_config()` (lines 62-65):
```rust
// Remove this block:
show_resurrectable_sessions: config
    .get("show_resurrectable_sessions")
    .map(|v| v == "true")
    .unwrap_or(false),
```

This simplifies the config since the feature is now runtime-toggled.
  </action>
  <verify>cargo build --target wasm32-wasip1 compiles; cargo test passes</verify>
  <done>Config no longer has show_resurrectable_sessions option; feature is purely runtime-toggled</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `cargo build --target wasm32-wasip1` succeeds
- [ ] `cargo test` passes (may need to adjust tests if any reference show_resurrectable_sessions)
- [ ] `cargo clippy --target wasm32-wasip1 -- -D warnings` passes
- [ ] Manual test: Open plugin, press Alt+D, verify resurrectable sessions appear in pink
</verification>

<success_criteria>

- All tasks completed
- Alt+D toggles resurrectable session visibility (hidden by default)
- Resurrectable sessions display in pink (color index 3) when visible
- Help text includes Alt+d hint
- Config no longer has show_resurrectable_sessions option
- All verification checks pass
  </success_criteria>

<output>
After completion, create `.planning/phases/08-resurrectable-session-improvements/08-01-SUMMARY.md`
</output>
